to population-model-min
  ;; 0-5 months
   if (ticks mod 30 = 0) [
   let sum112 S112 + E112 + I112 + R112
   set S112 S112 - (S112 / sum112 * 36.2)                
   set E112 E112 - (E112 / sum112 * 36.2) 
   set I112 I112 - (I112 / sum112 * 36.2)
   set R112 R112 - (R112 / sum112 * 36.2) 
   
   ;; 5 months - 5 years
   let sum212 S212 + E212 + I212 + R212
   set S212 S212 - (S212 / sum212 * 36.2)
   set E212 E212 - (E212 / sum212 * 36.2) 
   set I212 I212 - (I212 / sum212 * 36.2)
   set R212 R212 - (R212 / sum212 * 36.2)
   
   ;; 5 - 12 years
   let sum312 S312 + E312 + I312 + R312
   set S312 S312 - (S312 / sum312 * 36.2) 
   set E312 E312 - (E312 / sum312 * 36.2) 
   set I312 I312 - (I312 / sum312 * 36.2)  
   set R312 R312 - (R312 / sum312 * 36.2) 
     
   ;; 12- 17 years
   ;; Adjusted to ageingplus fractions
   let sum422 S422 + E422 + I422 + R422 
   set S422 S422 - (S422 / sum422 * (36.2 / 2)) 
   set E422 E422 - (E422 / sum422 * (36.2 / 2)) 
   set I422 I422 - (I422 / sum422 * (36.2 / 2))  
   set R422 R422 - (R422 / sum422 * (36.2 / 2))
   
   let sum412 S412 + E412 + I412 + R412 
   set S412 S412 - (S412 / sum412 * (36.2 / 2)) 
   set E412 E412 - (E412 / sum412 * (36.2 / 2)) 
   set I412 I412 - (I412 / sum412 * (36.2 / 2))
   set R412 R412 - (R412 / sum412 * (36.2 / 2))
   
   ;; 17- 25 years
   let sum511 S511 + E511 + I511 + R511
   set S511 S511 - (S511 / sum511 * 36.2) 
   set E511 E511 - (E511 / sum511 * 36.2)
   set I511 I511 - (I511 / sum511 * 36.2)
   set R511 R511 - (R511 / sum511 * 36.2) 
   
   ;; 25 - 35 years
   ;; Adjusted to ageingplus fractions
   let sum631 S631 + E631 + I631 + R631
   set S631 S631 - (S631 / sum631 * (36.2 * 0.495 * 0.9 * 0.961 ) )  
   set E631 E631 - (E631 / sum631 * (36.2 * 0.495 * 0.9 * 0.961 ) ) 
   set I631 I631 - (I631 / sum631 * (36.2 * 0.495 * 0.9 * 0.961 ) ) 
   set R631 R631 - (R631 / sum631 * (36.2 * 0.495 * 0.9 * 0.961 ) ) 
   
   let sum26312 S26312 + E26312 + I26312 + R26312
   set S26312 S26312 - (S26312 / sum26312 * (36.2 * 0.495 * 0.9 * 0.039) )
   set E26312 E26312 - (E26312 / sum26312 * (36.2 * 0.495 * 0.9 * 0.039) )
   set I26312 I26312 - (I26312 / sum26312 * (36.2 * 0.495 * 0.9 * 0.039) )
   set R26312 R26312 - (R26312 / sum26312 * (36.2 * 0.495 * 0.9 * 0.039) )
   
   let sum26111 S26111 + E26111 + I26111 + R26111
   set S26111 S26111 - (S26111 / sum26111 * (36.2 * 0.495 * 0.1 * 0.961) )
   set E26111 E26111 - (E26111 / sum26111 * (36.2 * 0.495 * 0.1 * 0.961) )
   set I26111 I26111 - (I26111 / sum26111 * (36.2 * 0.495 * 0.1 * 0.961) )
   set R26111 R26111 - (R26111 / sum26111 * (36.2 * 0.495 * 0.1 * 0.961) )
   
   let sum26112 S26112 + E26112 + I26112 + R26112
   set S26112 S26112 - (S26112 / sum26112 * (36.2 * 0.495 * 0.1 * 0.039) )  
   set E26112 E26112 - (E26112 / sum26112 * (36.2 * 0.495 * 0.1 * 0.039) )
   set I26112 I26112 - (I26112 / sum26112 * (36.2 * 0.495 * 0.1 * 0.039) )
   set R26112 R26112 - (R26112 / sum26112 * (36.2 * 0.495 * 0.1 * 0.039) )
   
   let sum36322 S36322 + E36322 + I36322 + R36322
   set S36322 S36322 - (S36322 / sum36322 * (36.2 * 0.505 * 0.8 * 0.167 * 1.0))
   set E36322 E36322 - (E36322 / sum36322 * (36.2 * 0.505 * 0.8 * 0.167 * 1.0))
   set I36322 I36322 - (I36322 / sum36322 * (36.2 * 0.505 * 0.8 * 0.167 * 1.0))
   set R36322 R36322 - (R36322 / sum36322 * (36.2 * 0.505 * 0.8 * 0.167 * 1.0))
   
   let sum36311 S36311 + E36311 + I36311 + R36311
   set S36311 S36311 - (S36311 / sum36311 * (36.2 * 0.505 * 0.8 * 0.833 * 0.961))
   set E36311 E36311 - (E36311 / sum36311 * (36.2 * 0.505 * 0.8 * 0.833 * 0.961)) 
   set I36311 I36311 - (I36311 / sum36311 * (36.2 * 0.505 * 0.8 * 0.833 * 0.961)) 
   set R36311 R36311 - (R36311 / sum36311 * (36.2 * 0.505 * 0.8 * 0.833 * 0.961))
   
   let sum36312 S36312 + E36312 + I36312 + R36312
   set S36312 S36312 - (S36312 / sum36312 * (36.2 * 0.505 * 0.8 * 0.833 * 0.039))
   set E36312 E36312 - (E36312 / sum36312 * (36.2 * 0.505 * 0.8 * 0.833 * 0.039))
   set I36312 I36312 - (I36312 / sum36312 * (36.2 * 0.505 * 0.8 * 0.833 * 0.039))
   set R36312 R36312 - (R36312 / sum36312 * (36.2 * 0.505 * 0.8 * 0.833 * 0.039)) 
   
   let sum36122 S36122 + E36122 + I36122 + R36122
   set S36122 S36122 - (S36122 / sum36122 * (36.2 * 0.505 * 0.2 * 0.167 * 1.0))
   set E36122 E36122 - (E36122 / sum36122 * (36.2 * 0.505 * 0.2 * 0.167 * 1.0))
   set I36122 I36122 - (I36122 / sum36122 * (36.2 * 0.505 * 0.2 * 0.167 * 1.0))
   set R36122 R36122 - (R36122 / sum36122 * (36.2 * 0.505 * 0.2 * 0.167 * 1.0))
   
   let sum36111 S36111 + E36111 + I36111 + R36111
   set S36111 S36111 - (S36111 / sum36111 * (36.2 * 0.505 * 0.2 * 0.833 * 0.961))  
   set E36111 E36111 - (E36111 / sum36111 * (36.2 * 0.505 * 0.2 * 0.833 * 0.961)) 
   set I36111 I36111 - (I36111 / sum36111 * (36.2 * 0.505 * 0.2 * 0.833 * 0.961)) 
   set R36111 R36111 - (R36111 / sum36111 * (36.2 * 0.505 * 0.2 * 0.833 * 0.961)) 
   
   let sum36112 S36112 + E36112 + I36112 + R36112
   set S36112 S36112 - (S36112 / sum36112 * (36.2 * 0.505 * 0.2 * 0.833 * 0.039))
   set E36112 E36112 - (E36112 / sum36112 * (36.2 * 0.505 * 0.2 * 0.833 * 0.039)) 
   set I36112 I36112 - (I36112 / sum36112 * (36.2 * 0.505 * 0.2 * 0.833 * 0.039))
   set R36112 R36112 - (R36112 / sum36112 * (36.2 * 0.505 * 0.2 * 0.833 * 0.039))
   
   ;; 35- 50 years
   ;; Adjusted to ageingplus fractions
   let sum17311 S17311 + E17311 + I17311 + R17311
   set S17311 S17311 - (S17311 / sum17311 * (36.2 * 0.7 * 0.8671 ) ) 
   set E17311 E17311 - (E17311 / sum17311 * (36.2 * 0.7 * 0.8671 ) ) 
   set I17311 I17311 - (I17311 / sum17311 * (36.2 * 0.7 * 0.8671 ) ) 
   set R17311 R17311 - (R17311 / sum17311 * (36.2 * 0.7 * 0.8671 ) )  
   
   let sum17312 S17312 + E17312 + I17312 + R17312
   set S17312 S17312 - (S17312 / sum17312 * (36.2 * 0.7 * 0.1329 ) ) 
   set E17312 E17312 - (E17312 / sum17312 * (36.2 * 0.7 * 0.1329 ) )
   set I17312 I17312 - (I17312 / sum17312 * (36.2 * 0.7 * 0.1329 ) )
   set R17312 R17312 - (R17312 / sum17312 * (36.2 * 0.7 * 0.1329 ) )
   
   let sum17111 S17111 + E17111 + I17111 + R17111
   set S17111 S17111 - (S17111 / sum17111 * (36.2 * 0.3 * 0.8671 ) ) 
   set E17111 E17111 - (E17111 / sum17111 * (36.2 * 0.3 * 0.8671 ) )
   set I17111 I17111 - (I17111 / sum17111 * (36.2 * 0.3 * 0.8671 ) ) 
   set R17111 R17111 - (R17111 / sum17111 * (36.2 * 0.3 * 0.8671 ) )
   
   let sum17112 S17112 + E17112 + I17112 + R17112
   set S17112 S17112 - (S17112 / sum17112 * (36.2 * 0.3 * 0.8671 ) )
   set E17112 E17112 - (E17112 / sum17112 * (36.2 * 0.3 * 0.8671 ) )
   set I17112 I17112 - (I17112 / sum17112 * (36.2 * 0.3 * 0.8671 ) )
   set R17112 R17112 - (R17112 / sum17112 * (36.2 * 0.3 * 0.8671 ) )
   
   ;; 50-65 years
   ;; Adjusted to ageingplus fractions
   let sum18311 S18311 + E18311 + I18311 + R18311
   set S18311 S18311 - (S18311 / sum18311 * (36.2 * 0.7 * 0.9363 ) )
   set E18311 E18311 - (E18311 / sum18311 * (36.2 * 0.7 * 0.9363 ) )
   set I18311 I18311 - (I18311 / sum18311 * (36.2 * 0.7 * 0.9363 ) )
   set R18311 R18311 - (R18311 / sum18311 * (36.2 * 0.7 * 0.9363 ) )
   
   let sum18312 S18312 + E18312 + I18312 + R18312
   set S18312 S18312 - (S18312 / sum18312 * (36.2 * 0.7 * 0.0637 ) )
   set E18312 E18312 - (E18312 / sum18312 * (36.2 * 0.7 * 0.0637 ) )
   set I18312 I18312 - (I18312 / sum18312 * (36.2 * 0.7 * 0.0637 ) )
   set R18312 R18312 - (R18312 / sum18312 * (36.2 * 0.7 * 0.0637 ) )
   
   let sum18111 S18111 + E18111 + I18111 + R18111
   set S18111 S18111 - (S18111 / sum18111 * (36.2 * 0.3 * 0.9363 ) )
   set E18111 E18111 - (E18111 / sum18111 * (36.2 * 0.3 * 0.9363 ) )
   set I18111 I18111 - (I18111 / sum18111 * (36.2 * 0.3 * 0.9363 ) )
   set R18111 R18111 - (R18111 / sum18111 * (36.2 * 0.3 * 0.9363 ) )
   
   let sum18112 S18112 + E18112 + I18112 + R18112
   set S18112 S18112 - (S18112 / sum18112 * (36.2 * 0.3 * 0.0637 ) )
   set E18112 E18112 - (E18112 / sum18112 * (36.2 * 0.3 * 0.0637 ) )
   set I18112 I18112 - (I18112 / sum18112 * (36.2 * 0.3 * 0.0637 ) )
   set R18112 R18112 - (R18112 / sum18112 * (36.2 * 0.3 * 0.0637 ) )
   
   ;; 65+ years
   let sum19111 S19111 + E19111 + I19111 + R19111
   set S19111 S19111 - (S19111 / sum19111 * 36.2) 
   set E19111 E19111 - (E19111 / sum19111 * 36.2) 
   set I19111 I19111 - (I19111 / sum19111 * 36.2) 
   set R19111 R19111 - (R19111 / sum19111 * 36.2) 
   ]
   
   ;;When only testing this population model
   ;set totalsusceptible S112 + S212 + S312 + S422 + S412 + S511 + S631 + S26312 + S26111 + S26112 + S36322 + S36311 + S36312 + S36122 + S36111 + S36112 + S17311 + S17312 + S17111 + S17112 + S18311 + S18312 + S18111 + S18112 + S19111
   ;set totalexposed E112 + E212 + E312 + E422 + E412 + E511 + E631 + E26312 + E26111 + E26112 + E36322 + E36311 + E36312 + E36122 + E36111 + E36112 + E17311 + E17312 + E17111 + E17112 + E18311 + E18312 + E18111 + E18112 + E19111
   ;set totalinfected I112 + I212 + I312 + I422 + I412 + I511 + I631 + I26312 + I26111 + I26112 + I36322 + I36311 + I36312 + I36122 + I36111 + I36112 + I17311 + I17312 + I17111 + I17112 + I18311 + I18312 + I18111 + I18112 + I19111    
   ;set totalrecovered R112 + R212 + R312 + R422 + R412 + R511 + R631 + R26312 + R26111 + R26112 + R36322 + R36311 + R36312 + R36122 + R36111 + R36112 + R17311 + R17312 + R17111 + R17112 + R18311 + R18312 + R18111 + R18112 + R19111

   ;set totalpopulation totalsusceptible + totalexposed + totalinfected + totalrecovered 

   set fractionsusceptible 1 / population * totalsusceptible
   set fractionexposed 1 / population * totalexposed
   set fractioninfected 1 / population * totalinfected
   set fractionrecovered 1 / population * totalrecovered
   
   ;;to check infections in age groups with several unique groups
   set suminfected1217 I422 + I412
   set suminfected2535 I631 + I26312 + I26111 + I26112 + I36322 + I36311 + I36312 + I36122 + I36111 + I36112
   set suminfected3550 I17311 + I17312 + I17111 + I17112    
   set suminfected5065 I18311 + I18312 + I18111 + I18112  
end


